<!DOCTYPE html>
<html lang="en" translate="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
  <title>colors</title>

  <link href="styles.css" rel="stylesheet">
</head>

<body id="body">
  <div id="colorContainer">
    <div id="image">
        <div id = "clockround">
		<div id = "sqr1" class = "clckrnd cell whitee"></div>
		<div id = "sqr2" class = "clckrnd cell whitee"></div>
		<div id = "sqr3" class = "clckrnd cell whitee"></div>
		<div id = "sqr4" class = "clckrnd cell whitee"></div>
		<div id = "sqr5" class = "clckrnd cell whitee"></div>
		<div id = "sqr6" class = "clckrnd cell whitee"></div>
		<div id = "sqr7" class = "clckrnd cell whitee" style="visibility: hidden"></div>
		<div id = "sqr8" class = "clckrnd cell whitee"></div>
		<div id = "sqr9" class = "clckrnd cell whitee"></div>
		<div id = "sqr10" class = "clckrnd cell whitee"></div>
		<div id = "sqr11" class = "clckrnd cell whitee"></div>
		<div id = "sqr12" class = "clckrnd cell whitee"></div>

    
    </div>
      <div id="color"><img id="lamp" src="lamp.png"></div>
      
    </div>
  </div>

  
    
    <div id="interface">
    
      <div id = "favourite">
        <div id="fav0" class="fav"></div>
        <div id="fav1" class="fav"></div>
        <div id="fav2" class="fav"></div>
        <div id="fav3" class="fav"></div>
        <div id="fav4" class="fav"></div>
        <div id="fav5" class="fav"></div>
        <div id="fav6" class="fav"></div>
        <div id="fav7" class="fav"></div>
        <div id="fav8" class="fav"></div>
        <div id="fav9" class="fav"></div>
      </div>

      <div id = "colorSelect">
          <div id="colorInput"> 
        <label id="colorLabel" for="colorSelector">Цвет&nbsp;свечения</label>
        <input type="color" value="#FFFF00" id="colorSelector"></div>
            <div id="confirmBut">
        <button id="confirm">Применить</button> </div> </div>
        <div id="checkboxDiv">           
           <label for="set" id="setLabel">Режим настройки цвета</label>
            <input type="checkbox" id="set">
    
        </div>
   
</div>
    
      <script>
          
          
          
          
          
/*const GITHUB_API_URL = "https://api.github.com";
const REPO_OWNER = "Mychesssite"; // Замените на ваш логин GitHub
const REPO_NAME = "flowerdata"; // Замените на название вашего репозитория
const FILE_PATH = "data.json"; // Путь к JSON-файлу
const TOKEN = ""; // Ваш GitHub токен*/


          
          
          
// Функция для получения содержимого файла
async function fetchColors() {
  const response = await fetch(
    `${GITHUB_API_URL}/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FILE_PATH}`,
    {
      headers: { Authorization: `token ${TOKEN}` },
    }
  );
  const data = await response.json();
  const content = atob(data.content); // Раскодировать base64
  return { colors: JSON.parse(content), sha: data.sha };
}

          
          
          
          
          
// Функция для сохранения нового цвета
async function saveColor(newColor, colorIndex = -1) //сли есть первый аргумент и второй то значение от второго аргумента обновляется значением New Color. Иначе добавляется новый аргумент в конец массива
          {
  const { colors, sha } = await fetchColors();

  // Добавить новый цвет
  colorIndex==-1 ? colors.push(newColor) : colors[index]=newColor;

  // Отправить обновленный JSON на GitHub
  const response = await fetch(
    `${GITHUB_API_URL}/repos/${REPO_OWNER}/${REPO_NAME}/contents/${FILE_PATH}`,
    {
      method: "PUT",
      headers: { 
        Authorization: `token ${TOKEN}`,
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        message: "Added a new color",
        content: btoa(JSON.stringify(colors, null, 2)), // Закодировать в base64
        sha, // Указать SHA текущего файла
      }),
    }
  );

  if (response.ok) {
    alert("Цвет сохранён!");
  } else {
    alert("Ошибка сохранения!");
    console.error(await response.text());
  }
}
          
          
          
          
          
          
          
          
          document.getElementById("confirm").onclick = 
          function()
          {
              let hexcl = document.getElementById("colorSelector").value;
              /*document.getElementById("colorSelector").style.backgroundColor = hexcl;*/
              document.getElementById("color").style.backgroundColor =hexcl;/*"rgba("+(document.getElementById("colorSelector").style.backgroundColor).slice(4,-1)+" ,1)";
              /*alert("rgba("+document.getElementById("colorSelector").style.backgroundColor.slice(4,-1)+" ,1)")*/
              let clr = [parseInt(hexcl.slice(1,3),16),parseInt(hexcl.slice(3,5),16),parseInt(hexcl.slice(5,7),16)];
              
              var formData = new FormData();
  // добавить к пересылке ещё пару ключ - значение
  //formData.append("type", "color");
  formData.append("red",clr[0]);
  formData.append("green", clr[1]);
  formData.append("blue", clr[2]);

  // отослать
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "http://192.168.100.74:10200/flower/data");
  xhr.send(formData);
  
          }
          /*var formData = new FormData();

  // добавить к пересылке ещё пару ключ - значение
  formData.append("plain", "success");

  // отослать
  var xhr = new XMLHttpRequest();
  xhr.open("POST", "http://192.168.100.74:10200/flower/data");
  xhr.send(formData);
  alert("data sent");*/
        </script>
    <script src="script.js" defer></script>
</body>